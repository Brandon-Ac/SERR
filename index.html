<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi PelÃ­cula Mental - Proyecto de Vida</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <audio id="bgMusic" loop></audio>

    <button id="musicToggle" class="music-control hidden" aria-label="Pausar/Reproducir mÃºsica">
        <span id="musicIcon">ğŸ”Š</span>
    </button>

    <div class="container">
        <header class="hero">
            <h1 class="title-cinema">MI PELÃCULA MENTAL</h1>
            <p class="subtitle">Descubre tu proyecto de vida a travÃ©s de preguntas poderosas</p>
        </header>

        <section id="musicSelectionScreen" class="screen active">
            <div class="welcome-card">
                <div class="cinema-icon">ğŸ¶</div>
                <h2>Elige tu Banda Sonora</h2>
                <p>La mÃºsica de fondo te ayudarÃ¡ a concentrarte y reflexionar. Â¿QuÃ© prefieres?</p>
                <div class="music-options">
                    <button class="btn-primary" onclick="playMusic('recommended')">Usar MÃºsica Recomendada (MÃ­stica)</button>
                    <div class="or-divider">o</div>
                    <div class="custom-music-wrapper">
                        <input type="file" id="audioFileUpload" class="hidden" accept="audio/*" onchange="playMusic('custom')">
                        <button class="btn-secondary" onclick="document.getElementById('audioFileUpload').click()">
                            Subir mi MÃºsica ğŸ“
                        </button>
                    </div>
                     <button class="btn-secondary no-music" onclick="playMusic('none')">Continuar sin MÃºsica</button>
                </div>
            </div>
        </section>

        <section id="questionnaireScreen" class="screen">
            <div class="questionnaire-card">
                <div class="question-header">
                     <img id="questionImage" src="" alt="Imagen de la pregunta" class="question-image">
                    <span class="question-category" id="questionCategory">CATEGORÃA</span>
                    <h2 class="question-title" id="questionTitle">Pregunta aquÃ­</h2>
                </div>
                
                <div class="question-body">
                    <textarea 
                        id="answerInput" 
                        rows="6" 
                        placeholder="Escribe tu respuesta aquÃ­..."
                        class="answer-textarea"
                    ></textarea>
                    
                    <div class="helper-text" id="helperText">
                        TÃ³mate tu tiempo. SÃ© honesto y especÃ­fico.
                    </div>
                </div>
                
                <div class="question-actions">
                    <button class="btn-secondary" id="prevBtn" onclick="previousQuestion()" disabled>
                        â† Anterior
                    </button>
                    <button class="btn-primary" id="nextBtn" onclick="nextQuestion()">
                        Siguiente â†’
                    </button>
                </div>
            </div>
            
            <div class="extra-actions">
                <button class="btn-tertiary" onclick="changeMusic()">Cambiar MÃºsica ğŸ¶</button>
            </div>

             <div id="progressBar" class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text"><span id="currentStep">1</span> de <span id="totalSteps">8</span></p>
            </div>
        </section>

        <section id="generationScreen" class="screen">
            <div class="generation-card">
                <div class="cinema-icon animate-pulse">ğŸ¬</div>
                <h2>Creando tu PelÃ­cula Mental...</h2>
                <p class="generation-text">Estamos procesando tus respuestas y generando las escenas de tu vida.</p>
                <div class="loader-cinema"></div>
                <p class="generation-status" id="generationStatus">Analizando tus fortalezas...</p>
            </div>
        </section>

        <section id="resultScreen" class="screen">
            <div class="result-header">
                <h2 class="section-title">ğŸï¸ Tu PelÃ­cula de Vida</h2>
                <div class="result-actions">
                    <button class="btn-secondary" onclick="restartJourney()">Crear Nueva PelÃ­cula</button>
                    <button class="btn-primary" onclick="downloadPDF()">Descargar PDF ğŸ“¥</button>
                </div>
            </div>
            
            <div id="movieTimeline" class="timeline">
                </div>
        </section>
    </div>

    <script src="script.js"></script>
</body>
</html>